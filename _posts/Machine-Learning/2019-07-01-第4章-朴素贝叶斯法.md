---
layout: post
title: 统计学习方法-第4章-朴素贝叶斯法
category: 机器学习
tags: 朴素贝叶斯法
keywords: 朴素贝叶斯法
description:
---

- 适用问题：多分类
- 模型特点：特征与类别的联合概率分布，条件独立假设
- 模型类型：生成模型
- 学习策略：极大似然估计，极大后验概率估计
- 损失函数：对数似然损失
- 学习算法：概率计算公式、EM算法


输入空间：$\mathcal{X} \subseteq \mathbf{R}^{n}$

输出空间：$\mathcal{Y} = \left\{ c_{1},c_{2},\cdots, c_{K} \right\}$

输入：$x \in \mathcal{X}$

输出：$y \in \mathcal{Y}$

$X$ 是定义在输入空间 $\mathcal{X}$ 上的随机变量

$Y$ 是定义在输入空间 $\mathcal{Y}$ 上的随机变量

训练数据集：$T = \left\{ \left( x_{1},y_{1} \right),\left( x_{2},y_{2} \right),\cdots,\left( x_{N},y_{N} \right) \right\}$

先验概率分布：$P \left( Y = c_{k}\right),\quad k = 1,2,\cdots,K \tag{4.1}$

条件概率分布：

$$
P \left( X = x \mid Y = c_{k}\right) = P \left( X^{\left( 1 \right)} = x^{\left( 1 \right)},\cdots,X^{\left( n \right)} = x^{\left( n \right)}\mid Y = c_{k} \right), \quad k = 1,2,\cdots,K \tag{4.2}
$$

- 注：条件概率分布有**指数级**数量的参数。假设 $x^{\left( j\right)}$ 可取值有 $S_{j}$ 个，$j = 1,2,\cdots,n$，$Y$ 可取值有 $K$ 个，那么参数个数为 $K\prod_{j=1}^{n} S_{j}$。

条件独立性假设：

$$
P \left( X = x \mid Y = c_{k}\right) = P \left( X^{\left( 1 \right)} = x^{\left( 1 \right)},\cdots, X^{\left( n \right)} = x^{\left( n \right)}\mid Y = c_{k}\right)
$$

$$
= \prod_{j=1}^{n} P \left( X^{\left( j \right)} = x^{\left( j \right)} \mid Y = c_{k}\right) \tag{4.3}
$$

后验概率分布（贝叶斯定理）：

$$
P \left( Y=c_{k} \mid X=x \right) = \frac{P \left( X=x \mid Y=c_{k} \right) P \left( Y=c_{k} \right)}{ P \left( X=x \right)}
$$

$$
= \frac{P \left( X=x \mid Y=c_{k} \right) P \left( Y=c_{k} \right)}{\sum_{k} P \left( X=x \mid Y=c_{k} \right) P \left( Y=c_{k} \right)} \tag{4.4}
$$

将 (4.3) 代入 (4.4) 有

$$
P \left( Y=c_{k} \mid X=x \right) = \frac{P \left( Y=c_{k} \right) \prod_{j} P \left( X^{\left( j \right)} = x^{\left( j \right)} \mid Y = c_{k}\right)}{\sum_{k} P \left( Y=c_{k} \right) \prod_{j} P \left( X^{\left( j \right)} = x^{\left( j \right)} \mid Y = c_{k}\right)}, \quad k = 1,2,\cdots,K \tag{4.5}
$$

朴素贝叶斯分类器：

$$
y = f\left( x \right) = \arg \max_{c_{k}} \frac{P \left( Y=c_{k} \right) \prod_{j} P \left( X^{\left( j \right)} = x^{\left( j \right)} \mid Y = c_{k}\right)}{\sum_{k} P \left( Y=c_{k} \right) \prod_{j} P \left( X^{\left( j \right)} = x^{\left( j \right)} \mid Y = c_{k}\right)}, \quad k = 1,2,\cdots,K \tag{4.6}
$$

(4.6) 中分母对于所有 $c_{k}$ 都是相同的，所以，

$$
y = \arg \max_{c_{k}} P \left( Y=c_{k} \right) \prod_{j} P \left( X^{\left( j \right)} = x^{\left( j \right)} \mid Y = c_{k}\right) \quad k = 1,2,\cdots,K \tag{4.7}
$$

假设算则 0-1 损失函数：

<div>
$$
L \left( Y,f \left( x \right) \right) =
\begin{cases}
1 & Y \neq f \left( x \right) \\
b & Y = f \left( x \right)
\end{cases}
$$
</div>