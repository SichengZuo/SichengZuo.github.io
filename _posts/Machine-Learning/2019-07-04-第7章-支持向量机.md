---
layout: post
title: 统计学习方法-第7章-支持向量机
category: 机器学习
tags: 支持向量机
keywords: 支持向量机
description:
---

- 适用问题：二分类
- 模型特点：分离超平面，核技巧
- 模型类型：判别模型
- 学习策略：极小化正则化合页损失，软间隔最大化
- 损失函数：合页损失
- 学习算法：序列最小最优化算法（SMO）

## 线性可分支持向量机

### 学习算法

输入：线性可分训练集 $T = \{ \left(x_{1},y_{1}\right),\left(x_{2},y_{2}\right), \cdots ,\left(x_{N},y_{N}\right) \}$，其中 $x_{i} \in \mathcal{X} = \mathbb{R^{n}},y_{i} \in \mathcal{Y} = \{ -1,+1 \},i = 1,2,\cdots,N$；

输出：分离超平面和分类决策函数。

1. 构造并求解约束最优化问题

    $$
    \min_{\alpha} \qquad \frac{1}{2} \sum_{i = 1}^N \sum_{j = 1}^N \alpha_{i} \alpha_{j} y_{i} y_{j} \left(x_{i} \cdot x_{j}\right) - \sum_{i=1}^m \alpha_{i}
    $$

    $$
    \text{s.t.} \qquad \sum_{i = 1}^{N} \alpha_{i} y_{i} = 0
    $$

    $$
    \alpha \geq 0,\qquad i = 1,2,\cdots,N
    $$

    求得最优解 $\alpha^{*} = \left( \alpha^{*}_{1}, \alpha^{*}_{2},\cdots,\alpha^{*}_{N} \right)^{T}$。

2. 计算

    $$
    w^{*} = \sum^{N}_{i = 1} \alpha_{i}^{*} y_{i} x_{i}
    $$

    并选择 $\alpha^{*}$ 的一个正分量 $\alpha_{j}^{*} > 0$，计算

    $$
    b^{*} = y_{j} - \sum_{i = 1}^{N} \alpha^{*}_{i} y^{*} \left( x_{i} \cdot x_{j} \right)
    $$

3. 求得分离超平面

    $$
    w^{*} \cdot x + b ^{*} = 0
    $$

    分类决策函数：

    $$
    f \left( x \right) = sign \left( w^{*} \cdot x + b ^{*} \right)
    $$

### 算法推导

**定义函数间隔**

样本点：

$$
\hat{\gamma_{i}} = y_{j} \left( w \cdot x_{i} + b\right)
$$

数据集：

$$
\hat{\gamma} = \min_i \hat{\gamma_{i}}
$$

- $w,b$ 等比例缩放，函数间隔会随之改变

**几何间隔**

样本点：

$$
\gamma_{i} = y_{j} \left( \frac{w}{\parallel w \parallel} \cdot x_{i} + \frac{b}{\parallel w \parallel} \right)
$$

数据集：

$$
\gamma = \min_i \gamma_{i}
$$

**函数间隔与几何间隔的关系**

$$
\gamma_{i} = \frac{\hat{\gamma_{i}}}{\parallel w \parallel}
$$

$$
\gamma = \frac{\hat{\gamma}}{\parallel w \parallel}
$$

**间隔最大化**——几何间隔最大化

<div>
$$
\left\{ \begin{array} { l l }
{ \max_{w,b} } & {\gamma}\\ 
{ s.t. } & { y_{i} \left( \frac{w}{\parallel w \parallel} \cdot x_{i} + \frac{b}{\parallel w \parallel} \right) \geq \gamma} 
\end{array} \right.
$$
</div>

根据集合间隔与函数间隔的关系，得

<div>
$$
\left\{ \begin{array} { l l }
{ \max_{w,b} } & {\frac{\hat{\gamma}}{\parallel w \parallel}}\\ 
{ s.t. } & { y_{i} \left(w \cdot x_{i} + b \right) \geq \hat{\gamma}}
\end{array} \right.
$$
</div>

令 $\hat{\gamma} = 1$，得

<div>
$$
\left\{ \begin{array} { l l }
{ \max_{w,b} } & {\frac{1}{\parallel w \parallel}}\\ 
{ s.t. } & { y_{i} \left( w \cdot x_{i} + b \right) \geq 1} 
\end{array} \right.
$$
</div>

最大化 $\frac{1}{\parallel w \parallel}$ 等价于最小化 $\frac{1}{2} {\parallel w \parallel}^{2}$。转为凸优化问题，$\frac{1}{2} {\parallel w \parallel}^{2}$ 为凸函数。得

<div>
$$
\left\{ \begin{array} { l l }
{ \min_{w,b} } & {\frac{1}{2} {\parallel w \parallel}^{2}}\\ 
{ s.t. } & { y_{i} \left( w \cdot x_{i} + b \right) \geq 1} 
\end{array} \right.
$$
</div>